{% load static %}
<!DOCTYPE html>
<!-- saved from url=(0087)http://ds.newhorizonbio.com/reportTimeline.html?id=bc1743a5-6b5f-452d-87b6-b38337207b0e -->
<html class="ui-mobile">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!--<base href="http://ds.newhorizonbio.com/reportTimeline.html?id=bc1743a5-6b5f-452d-87b6-b38337207b0e">-->
    <base href=".">

    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <title>诺辉健康</title>
    <!--css-->
    <script src="{% static 'js/commonCss.js' %}" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'css/jquery.mobile.structure-1.4.5.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/common.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/nhapp.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/nhicofont.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/iscrollAutoCreat.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/mobiscroll-2.11.1.full.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/photoswipe.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/default-skin.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/mobile-select-area.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/mobileSelect.css' %}">
    <!--js-->
    <script src="{% static 'js/commonJs.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/jquery-2.1.0.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/jquery.mobile-1.4.3.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/mobile.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/common.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/jquery.lazyload.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/swipe.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/jquery.validate.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/jquery.validate.addMethod.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/photoswipe.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/photoswipe-ui-default.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/creatPhotoswipe.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/iscroll-probe.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/iscrollAutoCreat.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/mobiscroll-2.11.1.full.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/dialog.js' %}"></script>
    <script src="{% static 'js/mobile-select-area.js' %}"></script>
    <script src="{% static 'js/timeCountDown.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/mobileSelect.js' %}" type="text/javascript"></script>
    <style>
        .stepsBox {
            padding: 0 1em;
            margin-top: -2em;
        }

        #steps {
            background: #fff;
            padding: 0.2em 0;
            border-radius: 0.5em;
        }

        .progressbar {
            font-family: montserrat, arial, verdana;
            margin: 15px;
            padding: 0;
            text-align: center;
            margin-bottom: 20px;
            overflow: hidden;
            counter-reset: step;
            z-index: 99;
        }

        .progressbar li {
            list-style-type: none;
            font-size: 12px;
            float: left;
            position: relative;
        }

        .progressbar li:before {
            content: counter(step);
            counter-increment: step;
            width: 40px;
            line-height: 40px;
            display: block;
            font-size: 12px;
            color: #333;
            background: #cccccc;
            border-radius: 40px;
            margin: 0 auto 5px auto;

        }

        .progressbar li:after {
            content: '';
            width: calc(100% - 40px);
            height: 2px;
            background: #cccccc;
            position: absolute;
            left: calc((-100% + 40px) / 2);
            top: 20px;
        }

        .progressbar li:before, .progressbar li:after {
            -webkit-transition: all .3s .2s linear;
            -moz-transition: all .3s .2s linear;
            -ms-transition: all .3s .2s linear;
            -o-transition: all .3s .2s linear;
            transition: all .3s .2s linear;
        }


        .progressbar li:first-child:after {
            content: none;
        }

        .progressbar li.active:before, .progressbar li.active:after {
            background: #40d4be;
            color: white;
            -webkit-transition: all .3s .2s linear;
            -moz-transition: all .3s .2s linear;
            -ms-transition: all .3s .2s linear;
            -o-transition: all .3s .2s linear;
            transition: all .3s .2s linear;
        }

        .pro-top {
            background: #36c7aa;
            height: 10em;
            padding-left: 2em;
        }

        .pro-top h1 {
            padding-top: 1.5em;
            color: #fff;
            font-size: 2em;
            font-weight: bolder;
        }

        .pro-top p {
            color: #fff;
        }

        .userBlockBox {
            width: 100%;
            padding: 1em 1em;
            box-sizing: border-box;
        }

        .userBlockBox .userBlock {
            padding: 0;
            margin: 0;
            border-radius: 10px;
        }

        .userBlockBox .btn-blue {
            background: linear-gradient(to right, #00e9d3, #40d4be);
            border-radius: 1.5em;
            width: 86%;
            margin: 2em auto 0;
        }

        .orderPayInfo-txt2 {
            padding: 0;
            margin: 0;
            background: none;
        }

        .orderPayInfo-txt2 .orderPayInfo-box {
            padding: 0;
            width: 100%;
            height: auto;
            padding-bottom: 1em;
            padding-top: 1em;
            line-height: normal;
        }

        .orderPayInfo-box.only-hint {
            color: #36c7aa;
        }

        .orderPayInfo-txt2 .hint-font {
            width: 20%;
            float: left;
            text-align: center;
        }

        .orderPayInfo-txt2 .hint-txt {
            width: 80%;
            box-sizing: border-box;
            padding-right: 1em;
            padding-top: 0.5em;
            float: left;
            margin: 0;
            line-height: normal;
        }

        .timeline-ul {
            box-sizing: border-box;
        }

        .timeline-ul .timeline-li {
            /*padding-bottom: 20px;*/
            position: relative;
            background: #fff;
            margin-top: 10px;
            height: 4em;
            padding: 0 10px;
            border-radius: 2em;
        }

        .timeline-ul .timeline-li .timeline-line {
            position: absolute;
            top: 2.8em;
            left: 5.6em;
            height: 100%;
            border-left: 2px dashed #25dcc6;
            z-index: 10000;
        }

        .timeline-ul .timeline-li .timeline-line.dis_none {
            display: none;
        }

        .timeline-ul .timeline-li .timeline-dot {
            position: absolute;
            background-color: #25dcc6;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            top: 1.5em;
            left: 5em;
            width: 20px;
            height: 20px;

        }

        /*.timeline-ul .timeline-li.active .timeline-line{*/
        /*border-left: 2px dashed #25dcc6;*/
        /*}*/
        .timeline-ul .timeline-li.active .timeline-dot {
            background-color: #e4e7ed;
        }

        .timeline-ul .timeline-li .timeline-content {
            position: relative;
            height: 100%;
            /*top: -3px;*/
        }

        .timeline-ul .timeline-li .timeline-tips {
            width: 35%;
            float: left;
            height: 100%;
            font-size: 12px;
            padding-top: 2em;
            padding-left: 0.5em;
            box-sizing: border-box;
        }

        .timeline-ul .timeline-li .timeline-title {
            /*margin-bottom: 8px;*/
            padding-top: 8px;
            color: #25dcc6;
            /*line-height: 1;*/
            font-size: 14px;
        }

        .timeline-ul .timeline-li.active .timeline-title, .timeline-ul .timeline-li.active .timeline-info, .timeline-ul .timeline-li.active .timeline-introduce {

        }

        .timeline-ul .timeline-li.active .timeline-info, .timeline-ul .timeline-li.active .timeline-introduce {


        }

        .timeline-ul .timeline-li .timeline-info {
            /*padding: 10px;*/
            font-size: 14px;
            width: 65%;
            height: 100%;
            float: left;;

        }

        .timeline-ul .timeline-li .timeline-introduce {
            color: #999;
            font-size: 12px;
            /*margin-top: 10px;*/
        }
    </style>
</head>
<body style="background:#f5f5f7;" class="ui-mobile-viewport ui-overlay-a">
<div data-role="page" id="reportTimeline" class="w-page2 ui-page ui-page-theme-a ui-page-active"
     data-url="reportTimeline" tabindex="0" style="">
    <form>
        <div role="main" class="ui-content ui-content-full">
            <div class="pro-top">
                <h1>感谢您的使用！</h1>
                <p>请您按以下流程完成检测</p>
            </div>
            <div class="stepsBox">
                <div id="steps">
                    <ul class="progressbar">
                        <li class="active" style="width: 25%;">个人信息录入/修改</li>
                        <li class="active" style="width: 25%;">样本回寄</li>
                        <li class="active" style="width: 25%;">检测进度查询</li>
                        <li style="width: 25%;">检测报告查询</li>
                    </ul>
                </div>
            </div>
            <div class="userBlockBox">
                <div class="orderPayInfo-txt2">
                    <div class="orderPayInfo-box only-hint">
                        <div class="hint-font">
                            <em class="nhicofont-hint_1" style="font-size: 2em;"></em>
                        </div>
                        <div class="hint-txt">
                            <p>检测前请完善个人信息，否则将会影响检测报告的出具。</p>
                        </div>
                    </div>
                </div>

                {% if project_code.project_code_status == 3 %}
                <ul class="timeline-ul" id="resultList">
                    <li class="timeline-li active"><span class="timeline-line "></span><span class="timeline-dot "></span>
                        <div class="timeline-content">
                            <div class="timeline-tips">样本检测完成</div>
                            <div class="timeline-info">
                                <div class="timeline-title">　</div>
                                <div class="timeline-introduce"><p>您的检测报告已完成，可以在线查看了（关注“诺辉”公众号）。</p></div>
                            </div>
                        </div>
                    </li>
                    <li class="timeline-li active"><span class="timeline-line "></span><span class="timeline-dot "></span>
                        <div class="timeline-content">
                            <div class="timeline-tips">样本正在检测</div>
                            <div class="timeline-info">
                                <div class="timeline-title">　</div>
                                <div class="timeline-introduce"><p>我们正在给您的样本做精密的全身体检，很快您就能收到它的报告啦!</p></div>
                            </div>
                        </div>
                    </li>
                    <li class="timeline-li active"><span class="timeline-linedis_none "></span><span class="timeline-dot "></span>
                        <div class="timeline-content">
                            <div class="timeline-tips">样本已签回</div>
                            <div class="timeline-info">
                                <div class="timeline-title">　</div>
                                <div class="timeline-introduce"><p>您的样本已到达实验室~我们会尽快为您安排检测，请您耐心等待。</p></div>
                            </div>
                        </div>
                    </li>
                </ul>
                    <button class="btn-blue ui-btn ui-shadow ui-corner-all"><a class="ui-link" href="{% url 'logistics:sreachOrder' %}?project_code={{ project_code }}">物流查询</a></button>
                {% endif %}

                 {% if project_code.project_code_status == 4 %}
                <ul class="timeline-ul" id="resultList">
                    <li class="timeline-li active"><span class="timeline-line "></span><span class="timeline-dot "></span>
                        <div class="timeline-content">
                            <div class="timeline-tips">样本检测完成</div>
                            <div class="timeline-info">
                                <div class="timeline-title">　</div>
                                <div class="timeline-introduce"><p>您的检测报告已完成，可以在线查看了（关注“诺辉”公众号）。</p></div>
                            </div>
                        </div>
                    </li>
                    <li class="timeline-li"><span class="timeline-line "></span><span class="timeline-dot "></span>
                        <div class="timeline-content">
                            <div class="timeline-tips">样本正在检测</div>
                            <div class="timeline-info">
                                <div class="timeline-title">　</div>
                                <div class="timeline-introduce"><p>我们正在给您的样本做精密的全身体检，很快您就能收到它的报告啦!</p></div>
                            </div>
                        </div>
                    </li>
                    <li class="timeline-li"><span class="timeline-linedis_none "></span><span class="timeline-dot "></span>
                        <div class="timeline-content">
                            <div class="timeline-tips">样本已签回</div>
                            <div class="timeline-info">
                                <div class="timeline-title">　</div>
                                <div class="timeline-introduce"><p>您的样本已到达实验室~我们会尽快为您安排检测，请您耐心等待。</p></div>
                            </div>
                        </div>
                    </li>
                </ul>
                {% endif %}
            </div>

        </div>
    </form>
    <script>
        $(document).on("pageshow", "#reportTimeline", function () {//pageshow在"去的"页面触发，在过渡动画完成后。
            $(function () {
                initStep();
            });

            function initStep() {
                // if(sessionStorage.getItem("appointType")==1){
                //     $("#steps").step({
                //         stepNames: ['个人信息录入/修改', '样本回寄', '检测进度查询', '检测报告查询',"采血"],
                //         initStep: 3
                //     })
                // }else {
                $("#steps").step({
                    stepNames: ['个人信息录入/修改', '样本回寄', '检测进度查询', '检测报告查询'],
                    initStep: 3
                })
                // }
            }

            var page = $(this);
            var id = request('id');
            var sampleNo = request('sampleNo');
            $.ajax({
                type: "post",
                async: false,
                data: {"id": id},
                url: '/postSampleReturnVideo',
                success: function (data) {
                    console.log(data);
                    if (data.productcode == '9901000601' || data.productcode == '0101000123' || data.productcode == '9901000123') {
                        $setAlert('页面建设中！', 10000);
                        $(".userBlockBox").html("");

                    } else {
                        $.ajax({
                            type: "post",
                            async: false,
                            data: JSON.stringify({id: id, sampleNo: sampleNo}),
                            url: '/testingProgress/jumpProgress',
                            contentType: "application/json;charset=utf-8",
                            dataType: 'json',
                            success: function (data) {
                                if (data.canAppointAgain) {
                                    $('.again-btn').css('display', 'block')
                                }
                                if (data.success) {
                                    var _html = ''
                                    for (var i = 0; i < data.nodeList.length; i++) {
                                        _html += '<li class="timeline-li ' + (i == 0 ? "active" : "") + '">' +
                                            '<span class="timeline-line' + (i == data.nodeList.length - 1 ? "dis_none" : "") + ' "></span>' +
                                            '<span class="timeline-dot "></span>' +
                                            '<div class="timeline-content">' +
                                            '<div class="timeline-tips" >' + data.nodeList[i].nodeName + '</div>' +
                                            '<div class="timeline-info">' +
                                            '<div class="timeline-title">' + data.nodeList[i].nodeTime + '</div>' +
                                            ' <div class="timeline-introduce">' +
                                            ' <p>' + (data.nodeList[i].nodeInfo ? data.nodeList[i].nodeInfo : "") + '</p>' +
                                            ' </div>' +
                                            ' </div>' +
                                            ' </div>' +
                                            '            </li>'

                                    }
                                    $("#resultList").html(_html);
                                } else {
                                    $setAlert(data.msg, 10000);

                                }
                            }
                        });
                    }
                }
            });

            $.fn.step = function (method) {
                if (methods[method]) {
                    return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
                } else if (typeof method === 'object' || !method) {
                    return methods.init.apply(this, arguments);
                } else {
                    $.error('Method ' + method + ' does not exist on jQuery.tooltip');
                }
            };

            var defStep = {
                stepNames: ['', '', ''],
                initStep: 1
            };

            var methods;
            methods = {
                init: function (options) {
                    // 初始化参数为空，使用默认设置
                    if (!options) {
                        options = defStep;
                    } else {
                        // 步骤名称判断
                        if (!options.stepNames || typeof options.stepNames !== "object") {
                            options.stepNames = defStep.stepNames;
                        }
                        // 初始化步骤判断
                        if (!options.initStep || isNaN(options.initStep) || options.initStep < 0) {
                            options.initStep = defStep.initStep;
                        }
                        // 初始化步骤大于最大值
                        if (options.initStep > options.stepNames.length) {
                            options.initStep = options.stepNames.length;
                        }
                    }
                    // 初始化样式
                    var html = '';
                    html += '<ul class="progressbar">';
                    $.each(options.stepNames, function (index, name) {
                        html += '<li';
                        if (index < options.initStep) {
                            html += ' class="active" ';
                        }
                        html += '>';
                        html += name;
                        html += '</li>';
                    });
                    html += '</ul>';
                    this.empty().append(html);
                    // 计算宽度
                    $(".progressbar li").css("width", 100 / options.stepNames.length + "%");

                    // 点击数字，跳转步骤
                    var _this = this
                    $(".progressbar li").click(function () {
                        var stepIndex = $(this).index();

//                            _this.step("goto", stepIndex)
                        if (stepIndex == 0) {
                            window.location.href = "addInfo_normal.html?id=" + id;
                        } else if (stepIndex == 1) {
                            window.location.href = "sampleReturn.html?id=" + id;
                        } else if (stepIndex == 2) {
                            window.location.href = "reportTimeline.html?id=" + id;
                        } else if (stepIndex == 3) {
                            window.location.href = "addInfo_normal_completed.html?id=" + id;
                        }
                        // else if(stepIndex==4){
                        //     window.location.href="activity_gzq.html?id="+id;
                        // }
                    })
                },


                goto: function (step) {
                    if (step < 0 || step > this.find("li").length) {
                        return;
                    }
                    this.find("li").removeClass("active");
                    var $target = this.find("li").eq(step - 1);
                    $target.addClass("active");
                    $target.prevAll("li").addClass("active");
                }
            };
        });
    </script>

</div>


<div class="ui-loader ui-corner-all ui-body-a ui-loader-default"><span class="ui-icon-loading"></span>
    <h1>loading</h1></div>
</body>
</html>